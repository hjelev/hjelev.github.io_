
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="http://home.masoko.net/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="http://home.masoko.net/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="http://home.masoko.net/theme/font-awesome/css/font-awesome.min.css">




    <link rel="shortcut icon" href="http://home.masoko.net/images/avatar2.jpg" type="image/x-icon">
    <link rel="icon" href="http://home.masoko.net/images/avatar2.jpg" type="image/x-icon">


    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333">

<meta name="author" content="Masoko" />
<meta name="description" content="This article will show you how to translate your Fask site using the python module Babel on a Debian based system running python 3. Install Flask-Babel First you need to install the python module Flask-Babel. $ sudo pip install Flask-Babel Configure Flask-Babel and hook it to your site Once Babel is …" />
<meta name="keywords" content="flask, python, babel, translate, multi language">

<meta property="og:site_name" content="My Blog/Notes"/>
<meta property="og:title" content="How to translate your Flask site with Babel"/>
<meta property="og:description" content="This article will show you how to translate your Fask site using the python module Babel on a Debian based system running python 3. Install Flask-Babel First you need to install the python module Flask-Babel. $ sudo pip install Flask-Babel Configure Flask-Babel and hook it to your site Once Babel is …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://home.masoko.net/translate-your-flask-site.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-02-24 00:00:00+01:00"/>
<meta property="article:modified_time" content="2018-02-24 00:00:00+01:00"/>
<meta property="article:author" content="http://home.masoko.net/author/masoko.html">
<meta property="article:section" content="Python"/>
<meta property="article:tag" content="flask"/>
<meta property="article:tag" content="python"/>
<meta property="article:tag" content="babel"/>
<meta property="article:tag" content="translate"/>
<meta property="article:tag" content="multi language"/>
<meta property="og:image" content="http://home.masoko.net/images/avatar2.jpg">

  <title>My Blog/Notes &ndash; How to translate your Flask site with Babel</title>

</head>
<body>
  <aside>
    <div>
      <a href="http://home.masoko.net">
        <img src="http://home.masoko.net/images/avatar2.jpg" alt="My Blog" title="My Blog">
      </a>
      <h1><a href="http://home.masoko.net">My Blog</a></h1>

<p>and notes</p>

      <ul class="social">
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="http://home.masoko.net">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>


    </nav>

<article class="single">
  <header>
      
    <h1 id="translate-your-flask-site">How to translate your Flask site with Babel</h1>
    <p>
          Posted on Sat 24 February 2018 in <a href="http://home.masoko.net/category/python.html">Python</a>


        &#8226; 2 min read
    </p>
  </header>


  <div>
    <p>This article will show you how to translate your Fask site using the python module Babel on a Debian based system running python 3.</p>
<h2>Install Flask-Babel</h2>
<p>First you need to install the python module <a href="https://pythonhosted.org/Flask-Babel/">Flask-Babel</a>.</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo pip install Flask-Babel
</pre></div>


<h2>Configure Flask-Babel and hook it to your site</h2>
<p>Once Babel is installed we'll need to configure it.</p>
<p>Create a file named ''babel.cfg'' in the root of your flask project and put the code below in it.</p>
<div class="highlight"><pre><span class="k">[python: **.py]</span>
<span class="k">[jinja2: **.html]</span>
<span class="na">extensions</span><span class="o">=</span><span class="s">jinja2.ext.autoescape,jinja2.ext.with_</span>
</pre></div>


<p>Now we need to hook babel to our flask application as shown below:</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="kn">from</span> <span class="nn">flask.ext.babel</span> <span class="kn">import</span> <span class="n">Babel</span><span class="p">,</span> <span class="n">gettext</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">babel</span> <span class="o">=</span> <span class="n">Babel</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre></div>


<p>Also we need to tell Babel what languages we need to support, put the code below in your application.
In this example, we add two locales, english (‘en’) and bulgarian (‘bg’).</p>
<div class="highlight"><pre># add to you main app code
LANGUAGES = {
    &#39;en&#39;: &#39;English&#39;,
    &#39;bg&#39;: &#39;Bulgarian&#39;
}
</pre></div>


<p>Finally we need to make our code select the best matching locale, based on the Accept-Language header from the incoming request.</p>
<div class="highlight"><pre># add to you main app code
@babel.localeselector
def get_locale():
    return request.accept_languages.best_match(LANGUAGES.keys())
</pre></div>


<h2>Tagging Strings for Translation</h2>
<p>Once you installed and configured Flask-Babel it’s time to tag all the Strings you want to translate. In a typical Flask app, there will be two types of Strings that require translating. One being hard-coded Strings in your .py files and the other being Strings in your .html Jinja2 templates.</p>
<h3>Tagging Strings in py files:</h3>
<div class="highlight"><pre>title = &#39;My home page title&#39;
print(&#39;Text for tanslation&#39;)
</pre></div>


<p>becomes</p>
<div class="highlight"><pre>title = gettext(&#39;My home page title&#39;)
print(gettext(&#39;Text for tanslation&#39;))
</pre></div>


<h3>Tagging Strings in  Jinja2 templates:</h3>
<div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;lead&quot;</span><span class="nt">&gt;</span>Movies found today.<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Search&quot;</span><span class="nt">/&gt;</span>
</pre></div>


<p>becomes</p>
<div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;lead&quot;</span><span class="nt">&gt;</span> <span class="cp">{{</span> <span class="nv">gettext</span><span class="o">(</span><span class="s1">&#39;Movies found today.&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">gettext</span><span class="o">(</span><span class="s1">&#39;Search&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">/&gt;</span>
</pre></div>


<p>You can use _() as a shortcut for gettext().</p>
<h2>Building Locales</h2>
<p>Once we have tagged all the string in our code and templates, its time to build a catalog for the Locales we want to create.  Run:</p>
<div class="highlight"><pre><span class="nv">$ </span>pybabel extract -F babel.cfg -o messages.pot --input-dirs<span class="o">=</span>.
</pre></div>


<p>This checks all files specified in babel.cfg and searches through them to find tagged strings and outputs them to messages.pot.
After all the translated strings are indexed its time to initialize our locale:</p>
<div class="highlight"><pre><span class="nv">$ </span>pybabel init -i messages.pot -d translations -l <span class="nb">bg</span>
</pre></div>


<p>The example above initializes the Bulgarian locale and creates the files we need to translate.
Open <code>translations/bg/LC_MESSAGES/messages.po</code> with you favorite text editor and translate the msgstr values for all the strings you have tagged. </p>
<p>The final step to get your site translated is to compile the <code>messages.po</code> file, to do so run the command below:</p>
<div class="highlight"><pre><span class="nv">$ </span>pybabel compile -d translations
</pre></div>


<h2>Updating locales</h2>
<p>After a while you'll add new content to your site and there will be new strings for translation.
Run again this command to extract the new strings:</p>
<div class="highlight"><pre><span class="nv">$ </span>pybabel extract -F babel.cfg -o messages.pot --input-dirs<span class="o">=</span>.
</pre></div>


<p>Then run pybabel update to update your locale file <code>messages.po</code></p>
<div class="highlight"><pre><span class="nv">$ </span>pybabel update -i messages.pot -d translations
</pre></div>


<p>Translate the new strings and compile your locale:</p>
<div class="highlight"><pre><span class="nv">$ </span>pybabel compile -d translations
</pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="http://home.masoko.net/tag/flask.html">flask</a>
      <a href="http://home.masoko.net/tag/python.html">python</a>
      <a href="http://home.masoko.net/tag/babel.html">babel</a>
      <a href="http://home.masoko.net/tag/translate.html">translate</a>
      <a href="http://home.masoko.net/tag/multi-language.html">multi language</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="http://home.masoko.net/build-cheap-multi-room-audio-system.html" title="Build a Cheap Multi-Room Audio System">
      <i class="fa fa-angle-left"></i>     Previous Post

    </a>
  </div>

  <div class="related-posts">
    <h4>    You might enjoy
</h4>
    <ul class="related-posts">
      <li><a href="http://home.masoko.net/multiple-python-sites-on-one-host.html">How to Host Multiple Python Apps on the Same Host With Nginx</a></li>
      <li><a href="http://home.masoko.net/python-modules.html">Python Modules I Use</a></li>
    </ul>
  </div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'my-blog-notes';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>&copy;  2018</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " My Blog/Notes ",
  "url" : "http://home.masoko.net",
  "image": "http://home.masoko.net/images/avatar2.jpg",
  "description": "Foo Bar's Thoughts and Writings"
}
</script>

  
	<!-- Start of StatCounter Code for Default Guide -->
	<script type="text/javascript">
	var sc_project=11606772; 
	var sc_invisible=1; 
	var sc_security="2a877137"; 
	var scJsHost = (("https:" == document.location.protocol) ?
	"https://secure." : "http://www.");
	document.write("<sc"+"ript type='text/javascript' src='" +
	scJsHost+
	"statcounter.com/counter/counter.js'></"+"script>");
	</script>
	<noscript><div class="statcounter"><a title="Web Analytics
	Made Easy - StatCounter" href="http://statcounter.com/"
	target="_blank"><img class="statcounter"
	src="//c.statcounter.com/11606772/0/2a877137/1/" alt="Web
	Analytics Made Easy - StatCounter"></a></div></noscript>
	<!-- End of StatCounter Code for Default Guide -->

</body>
</html>