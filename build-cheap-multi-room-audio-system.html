
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://hjelev.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://hjelev.github.io/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://hjelev.github.io/theme/font-awesome/css/font-awesome.min.css">




    <link rel="shortcut icon" href="https://hjelev.github.io//images/avatar2.jpg" type="image/x-icon">
    <link rel="icon" href="https://hjelev.github.io//images/avatar2.jpg" type="image/x-icon">


    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333">

<meta name="author" content="Masoko" />
<meta name="description" content="How to build cheap Multi-Room Audio System with raspberry pis for network players and logitec media server. Logitec Media Server LMS is a media server made for the logitec squeezebox Network music players. We will use this software for our project and will build squeezebox players using a raspberry pi …" />
<meta name="keywords" content="lms, multi-room, audio, spotify, logitec media server, rpi">

<meta property="og:site_name" content="My Blog/Notes"/>
<meta property="og:title" content="Build a Cheap Multi-Room Audio System"/>
<meta property="og:description" content="How to build cheap Multi-Room Audio System with raspberry pis for network players and logitec media server. Logitec Media Server LMS is a media server made for the logitec squeezebox Network music players. We will use this software for our project and will build squeezebox players using a raspberry pi …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://hjelev.github.io/build-cheap-multi-room-audio-system.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-01-21 00:00:00+01:00"/>
<meta property="article:modified_time" content="2018-01-21 00:00:00+01:00"/>
<meta property="article:author" content="https://hjelev.github.io/author/masoko.html">
<meta property="article:section" content="Raspberry pi"/>
<meta property="article:tag" content="lms"/>
<meta property="article:tag" content="multi-room"/>
<meta property="article:tag" content="audio"/>
<meta property="article:tag" content="spotify"/>
<meta property="article:tag" content="logitec media server"/>
<meta property="article:tag" content="rpi"/>
<meta property="og:image" content="https://hjelev.github.io//images/avatar2.jpg">

  <title>My Blog/Notes &ndash; Build a Cheap Multi-Room Audio System</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://hjelev.github.io">
        <img src="https://hjelev.github.io//images/avatar2.jpg" alt="My Blog" title="My Blog">
      </a>
      <h1><a href="https://hjelev.github.io">My Blog</a></h1>

<p>and notes</p>

      <ul class="social">
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://hjelev.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>


    </nav>

<article class="single">
  <header>
      
    <h1 id="build-cheap-multi-room-audio-system">Build a Cheap Multi-Room Audio System</h1>
    <p>
          Posted on Sun 21 January 2018 in <a href="https://hjelev.github.io/category/raspberry-pi.html">Raspberry pi</a>


        &#8226; 7 min read
    </p>
  </header>


  <div>
    <p>How to build cheap Multi-Room Audio System with raspberry pis for network players and logitec media server.</p>
<p>Logitec Media Server <a href="https://www.mysqueezebox.com/download" target="_blank">LMS</a> is a media server made for the logitec squeezebox Network music players. We will use this software for our project and will build squeezebox players using a raspberry pi, USB sound card and some multimedia speakers.</p>
<h2>The parts we need:</h2>
<ol>
<li><strong>Raspberry Pi Zero W</strong> (you can use other models but this is the perfect one)</li>
<li>Any <strong>SD card</strong> that can fit raspbian light - bigger cards will last longer.</li>
<li><strong>USB sound card</strong> (I have used this cheap $1.5 <a href="https://www.gearbest.com/cables-connectors/pp_621980.html" target="_blank">sound card</a> from gearbest.com)</li>
<li><strong>Micro USB Male to USB Female Cable Adapter</strong> - we need this as the raspberry pi zero have only one micro usb port.</li>
<li><strong>Micro USB cable</strong> and <strong>5v power supply</strong> to power the raspberry pi. </li>
<li><strong>Multimedia Speakers</strong> with 3.5 inch audio input.<br>
I have started my multi-room audio system with Logitech Multimedia 2.1 Speakers Z213 as they are very cheap and offer decent sound for their price - around $25. Later I have picked Logitech Z333.</li>
<li><strong>USB hub</strong> and <strong>USB network card</strong> - wi-fi or wired depending on your need - (You'll need this if you don't use pi zero w)</li>
</ol>
<p>These are the parts we need to build one of ours network music players.</p>
<p>We also need a computer for the Logitec Media Server - in my experience this server works best on windows computers. 
I am hosting mine on a PIPO X8 its a tablet like computer with 12v power supply, Windows 10, Intel Z3736F Quad Core CPU, 2GB ram and 64GB disk space. </p>
<p>For the hosting of the logitec media server you can use your desktop computer, an old laptop, a raspberry pi (model 3 or 2), Netgear NAS and maybe something else. </p>
<p>Go to <a href="https://www.mysqueezebox.com/download" target="_blank">Logitec Media Server</a> site and download the version matching your OS choice.</p>
<p><a href="http://wiki.slimdevices.com/index.php/Logitech_Media_Server#Installing_to_a_Computer_or_Laptop" target="_blank">Here you can find instructions for installing LMS on different operation systems</a></p>
<h2>Preparing the raspberry pi SD card:</h2>
<p>I'll show you how to prepare the SD card with a windows computer. This is the SD card we'll use for our network music players.</p>
<ol>
<li>Download and install <a href="https://sourceforge.net/projects/win32diskimager/" target="_blank">Win32 Disk Imager</a> on your PC.</li>
<li>Download <a href="https://www.raspberrypi.org/downloads/raspbian/" target="_blank">Raspbian Stretch Lite</a> image from raspberrypi.org site. (you can also use the full version but there is no need to do so and its bigger)</li>
<li>Use Win32 disk imager to write the rasbian image you have just downloaded to the SD card.</li>
<li>If you plan to connect this player/rpi via wifi, now is the time to configure the wi-fi network credentials (if you don't do so now you'll have to attach monitor and a keyboard to your rpi later)<br>
 Create a file <code>wpa_supplicant.conf</code> and place it in the <code>boot</code> partition.<br>
 wpa_supplicant.conf<br>
  <pre>
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
network={
    ssid="YourNetworkSSID-1"
    psk="passwordOne"
  }</pre></li>
<li>To enable ssh create an empty file named <code>ssh</code> and place it in the boot partition.  </li>
<li>Insert the SD card in the raspberry pi, connect the USB sound card using the cable adapter, connect the 5v power supply, after less than 1 minute it should boot and connect to the network.  </li>
<li>Now you need to find the ip address of the raspberry pi, you can do that by checking the DHCP clients in you router control panel or use your phone and an application like <a href="https://play.google.com/store/apps/details?id=com.overlook.android.fing" target="_blank">Fing</a> (there is also an iphone version of Fing)  </li>
<li>Once you find the ip address ssh to it using <a href="https://www.putty.org/" target="_blank">Putty</a> or your favorite ssh client.<br>
 When connecting use user <code>pi</code> and password <code>raspberry</code><br>
 After you login for a first time change the default password with<br>
 <pre>$ passwd</pre> </li>
<li>Update your system packages by running
 <pre>$ sudo apt-get -y update &amp;&amp; sudo apt-get -y dist-upgrade</pre>
 This will take some time.  </li>
<li>Install some libraries that are needed by squeezelite <br>
 <pre>$ sudo apt-get install -y libflac-dev libfaad2 libmad0</pre>  </li>
<li>
<p>Create a folder for squeezelite and download it:
 <pre>$ mkdir squeezelite
$ cd squeezelite
$ wget -O squeezelite-armv6hf.tar.gz http://www.gerrelt.nl/RaspberryPi/squeezelite_ralph/squeezelite-armv6hf.tar.gz
$ tar -xvzf squeezelite-armv6hf.tar.gz</pre>
<a href="https://sourceforge.net/projects/lmsclients/files/squeezelite/linux/" target="_blank">Here</a> you can find Squeezelite and other LMS Clients for different OS.</p>
</li>
<li>
<p>Now set the sound level:
<pre>$ sudo alsamixer</pre>
Use the <code>F6</code> key to select the right sound card (I am using an USB sound card), and then set the volume using the arrow keys. Set the volume just before the red zone also set the microphone volume to zero, to make sure it will not cause any noise.</p>
</li>
<li>Before we can run squeezelite we need to find the name of our usb sound card.
<pre>$ ./squeezelite -l</pre>
You'll get an output like the one below:
 <pre>
Output devices:
  null                           - Discard all samples (playback) or generate zero samples (capture)
  pulse                          - PulseAudio Sound Server
  default:CARD=ALSA              - bcm2835 ALSA, bcm2835 ALSA - Default Audio Device
  sysdefault:CARD=ALSA           - bcm2835 ALSA, bcm2835 ALSA - Default Audio Device
  dmix:CARD=ALSA,DEV=0           - bcm2835 ALSA, bcm2835 ALSA - Direct sample mixing device
  dmix:CARD=ALSA,DEV=1           - bcm2835 ALSA, bcm2835 IEC958/HDMI - Direct sample mixing device
  dsnoop:CARD=ALSA,DEV=0         - bcm2835 ALSA, bcm2835 ALSA - Direct sample snooping device
  dsnoop:CARD=ALSA,DEV=1         - bcm2835 ALSA, bcm2835 IEC958/HDMI - Direct sample snooping device
  hw:CARD=ALSA,DEV=0             - bcm2835 ALSA, bcm2835 ALSA - Direct hardware device without any conversions
  hw:CARD=ALSA,DEV=1             - bcm2835 ALSA, bcm2835 IEC958/HDMI - Direct hardware device without any conversions
  plughw:CARD=ALSA,DEV=0         - bcm2835 ALSA, bcm2835 ALSA - Hardware device with all software conversions
  plughw:CARD=ALSA,DEV=1         - bcm2835 ALSA, bcm2835 IEC958/HDMI - Hardware device with all software conversions
  default:CARD=Device            - USB Audio Device, USB Audio - Default Audio Device
  sysdefault:CARD=Device         - USB Audio Device, USB Audio - Default Audio Device
  front:CARD=Device,DEV=0        - USB Audio Device, USB Audio - Front speakers
  surround21:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 2.1 Surround output to Front and Subwoofer speakers
  surround40:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 4.0 Surround output to Front and Rear speakers
  surround41:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 4.1 Surround output to Front, Rear and Subwoofer speakers
  surround50:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 5.0 Surround output to Front, Center and Rear speakers
  surround51:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 5.1 Surround output to Front, Center, Rear and Subwoofer speakers
  surround71:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 7.1 Surround output to Front, Center, Side, Rear and Woofer speakers
  iec958:CARD=Device,DEV=0       - USB Audio Device, USB Audio - IEC958 (S/PDIF) Digital Audio Output
  dmix:CARD=Device,DEV=0         - USB Audio Device, USB Audio - Direct sample mixing device
  dsnoop:CARD=Device,DEV=0       - USB Audio Device, USB Audio - Direct sample snooping device
  hw:CARD=Device,DEV=0           - USB Audio Device, USB Audio - Direct hardware device without any conversions
  plughw:CARD=Device,DEV=0       - USB Audio Device, USB Audio - Hardware device with all software conversions
 </pre>
Since we are using a USB Audio Device we need to pick one of the listed USB devices. I am using <code>front:CARD=Device,DEV=0</code> as it works best for me. 
You can test the other USB devices and decide for yourself.
<pre>$ ./squeezelite -n Player-location -m 15:c4:20:16:b7:4f -o front:CARD=Device,DEV=0</pre>
<code>-n</code> sets the name of the player - the name that you'll see when you control it.<br>
<code>-m</code> is the mac address of the network player - pick a random mac address - it should be unique for each player in your network.<br>
<code>-o</code> is the output device used for the playback (your USB sound card)<br>
If you don't see any error go to logitec media server and check if you see your new player (the players are listed in the top right section of LMS web control panel). 
You can test the player to make sure its working properly.
When done testing you can close the server with <code>Ctrl+C</code></li>
<li>Starting Squeezelite on Startup.<br>
There are many ways you can use to start the player on start up. The easiest one I have found is using <code>crontab</code>.
<pre>$ crontab -e</pre>
and add this line some where in the file 
<pre>@reboot sudo -u pi /home/pi/squeezelite/squeezelite -n Player_Name -m 15:c4:20:16:b7:4f -o front:CARD=Device,DEV=0 &amp; </pre></li>
<li>Reboot your raspberry pi to make sure the player is loaded on startup.
This is all you need to do to create a new network music player for your multi-room audio system. 
For the other players you need to repeat all the steps described above and pick a different mac (-m) address and name (-n) in the player configuration step.</li>
</ol>
<h2>Stability of the system</h2>
<p>The players can work fine on wi-fi if you have decent wi-fi coverage.<br>
It is recommended that you run your LM server on a wired connection thus it can also work on wi-fi.</p>
<p>The stability of the players mainly depends on the choice of the USB sound card. I have tested maybe 5 different cheap (up to $3) sound cards and only the one listed in the parts section works without causing problems. The others will make the player hung in silence or repeating a very annoying sound. 
If you use raspbery pi zero, when playing music the CPU load should be around 0.15.
If you want better sound and you can afford to pay more you can build your players with <a href="https://www.hifiberry.com/" target="_blank">HiFiBerry Amplifier</a> or some other rapsberry pi compatible Amplifier.</p>
<p>Using a bad SD card can also affect the system stability.</p>
<p>I am using such multi-room audio system with 2 raspbery pi network players that run 24/7 - one on wi-fi the other on LAN and there are months with no outages.
There is also a third player on my windows desktop PC - this one causes no issues but it is rebooted daily.</p>
<p>If some player (mainly the wi-fi one) disappears from the network or I don't see it in LMS I just restart it from the plug and it comes back in a minute.</p>
<p>You can start a network player on the computer running the logitec media server using a build in plug-in.</p>
<h2>What media is supported by my multi-room audio system?</h2>
<p>Logitec Media Server supports many audio sources that you can enjoy now:</p>
<ol>
<li>Your own MP3 collection, it can be located on any samba share in your network or the computer running the server.</li>
<li>Spotify - you need a paid account.</li>
<li>Many free on-line sources like SomaFM, SoundClound, TuneIn Radio (tons of on-line radio stations), You Tube and others - these depends on your location. You can see them all <a href="https://www.mysqueezebox.com/appgallery" target="_blank">here</a>.</li>
<li>Custom streams from URLs you add.</li>
</ol>
<p>You can use your new multi-room audio system to play synchronized music in all of your rooms or if you prefer you can play different music in each room. You can also have a group of synchronized players and stand alone players playing different music.</p>
<h2>How can we Control the system?</h2>
<p>The easiest way is to use the web interface located at http://lms_server_ip:9000 (you can change that port to 80 from LMS configuration)</p>
<p>You can also use a phone application to play your music. The best I found for android phones is <a href="https://play.google.com/store/apps/details?id=uk.org.ngo.squeezer" target="_blank">squeezer</a>. It automatically discovers my LSM when on the same network and allows me to control most of the functions of the server.</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://hjelev.github.io/tag/lms.html">lms</a>
      <a href="https://hjelev.github.io/tag/multi-room.html">multi-room</a>
      <a href="https://hjelev.github.io/tag/audio.html">audio</a>
      <a href="https://hjelev.github.io/tag/spotify.html">spotify</a>
      <a href="https://hjelev.github.io/tag/logitec-media-server.html">logitec media server</a>
      <a href="https://hjelev.github.io/tag/rpi.html">rpi</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="https://hjelev.github.io/multiple-python-sites-on-one-host.html" title="How to Host Multiple Python Apps on the Same Host With Nginx">
      <i class="fa fa-angle-left"></i>     Previous Post

    </a>
    <a class="btn float-right" href="https://hjelev.github.io/translate-your-flask-site.html" title="How to translate your Flask site with Babel">
          Next Post
 <i class="fa fa-angle-right"></i>
    </a>
  </div>

  <div class="related-posts">
    <h4>    You might enjoy
</h4>
    <ul class="related-posts">
      <li><a href="https://hjelev.github.io/os-raspberry-pi.html">OS for Raspberry Pi</a></li>
      <li><a href="https://hjelev.github.io/rpi-software.html">Software for Raspberry Pi</a></li>
      <li><a href="https://hjelev.github.io/iptables-example.html">Basic IPTables Tutorial</a></li>
    </ul>
  </div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'my-blog-notes';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>&copy;  2018</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " My Blog/Notes ",
  "url" : "https://hjelev.github.io",
  "image": "https://hjelev.github.io//images/avatar2.jpg",
  "description": "Notes about the things I learn"
}
</script>

  
	<!-- Start of StatCounter Code for Default Guide -->
	<script type="text/javascript">
	var sc_project=11606772; 
	var sc_invisible=1; 
	var sc_security="2a877137"; 
	var scJsHost = (("https:" == document.location.protocol) ?
	"https://secure." : "http://www.");
	document.write("<sc"+"ript type='text/javascript' src='" +
	scJsHost+
	"statcounter.com/counter/counter.js'></"+"script>");
	</script>
	<noscript><div class="statcounter"><a title="Web Analytics
	Made Easy - StatCounter" href="http://statcounter.com/"
	target="_blank"><img class="statcounter"
	src="//c.statcounter.com/11606772/0/2a877137/1/" alt="Web
	Analytics Made Easy - StatCounter"></a></div></noscript>
	<!-- End of StatCounter Code for Default Guide -->

</body>
</html>