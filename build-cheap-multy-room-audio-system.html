
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="http://home.masoko.net/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="http://home.masoko.net/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="http://home.masoko.net/theme/font-awesome/css/font-awesome.min.css">




    <link rel="shortcut icon" href="http://home.masoko.net/images/avatar2.jpg" type="image/x-icon">
    <link rel="icon" href="http://home.masoko.net/images/avatar2.jpg" type="image/x-icon">


    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333">

<meta name="author" content="Masoko" />
<meta name="description" content="How to build cheap Multy-Room Audio System with raspberry pis and logitec media server. Logitec Media Server LMS is a media server made for the logitec squeezebox Network music players. We will use this software for our project and will build squeezebox players using a raspberry pi, usb soundcard and …" />
<meta name="keywords" content="lms, multi-room, audio, spotify, logitec media server, rpi">

<meta property="og:site_name" content="My Blog/Notes"/>
<meta property="og:title" content="Build Cheap Multy-Room Audio System"/>
<meta property="og:description" content="How to build cheap Multy-Room Audio System with raspberry pis and logitec media server. Logitec Media Server LMS is a media server made for the logitec squeezebox Network music players. We will use this software for our project and will build squeezebox players using a raspberry pi, usb soundcard and …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://home.masoko.net/build-cheap-multy-room-audio-system.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-01-21 00:00:00+01:00"/>
<meta property="article:modified_time" content="2018-01-21 00:00:00+01:00"/>
<meta property="article:author" content="http://home.masoko.net/author/masoko.html">
<meta property="article:section" content="Raspberry pi"/>
<meta property="article:tag" content="lms"/>
<meta property="article:tag" content="multi-room"/>
<meta property="article:tag" content="audio"/>
<meta property="article:tag" content="spotify"/>
<meta property="article:tag" content="logitec media server"/>
<meta property="article:tag" content="rpi"/>
<meta property="og:image" content="http://home.masoko.net/images/avatar2.jpg">

  <title>My Blog/Notes &ndash; Build Cheap Multy-Room Audio System</title>

</head>
<body>
  <aside>
    <div>
      <a href="http://home.masoko.net">
        <img src="http://home.masoko.net/images/avatar2.jpg" alt="My Blog" title="My Blog">
      </a>
      <h1><a href="http://home.masoko.net">My Blog</a></h1>

<p>and notes</p>

      <ul class="social">
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="http://home.masoko.net">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>


    </nav>

<article class="single">
  <header>
      
    <h1 id="build-cheap-multy-room-audio-system">Build Cheap Multy-Room Audio System</h1>
    <p>
          Posted on Sun 21 January 2018 in <a href="http://home.masoko.net/category/raspberry-pi.html">Raspberry pi</a>


        &#8226; 7 min read
    </p>
  </header>


  <div>
    <p>How to build cheap Multy-Room Audio System with raspberry pis and logitec media server.
Logitec Media Server <a href="https://www.mysqueezebox.com/download">LMS</a> is a media server made for the logitec squeezebox Network music players. We will use this software for our project and will build squeezebox players using a raspberry pi, usb soundcard and some multimedia speakers.</p>
<p>I have started my multi-room audio system with Logitech Multimedia 2.1 Speakers Z213 as they are very cheap and offer decent sound for their price - around $25. Later I have picked Logitech Z333.</p>
<h2>The parts we need.</h2>
<ol>
<li><strong>Raspberry Pi Zero W</strong> (you can use other models but this is the perfect one)</li>
<li>Any <strong>sd card</strong> that can fit raspbian light - bigger cards will last longer.</li>
<li><strong>Usb sound card</strong> (I have used this cheap $1.5 <a href="https://www.gearbest.com/cables-connectors/pp_621980.html">sound card</a> from gearbest.com)</li>
<li><strong>Micro USB Male to USB Female Cable Adapter</strong> - we need this as the raspberry pi zero have only one micro usb port.</li>
<li>Multimedia Speakers with 3.5 inch audio input.</li>
<li>You'll need this if you don't use pi zero w: <strong>USB hub</strong> and <strong>USB network card</strong> - wifi or wired depending on your need.</li>
<li>We also need a Computer for the Logitec Media Server - in my experience this server works best on windows computers. I am hosting mine on a PIPO X8 its a tablet like computer with Windows 10, Intel Z3736F Quad Core, 2GB ram and 64GB disk space. </li>
</ol>
<p>You can use your home computer, a laptop or a raspberry pi 3 or 2 model. </p>
<p>Go to <a href="https://www.mysqueezebox.com/download">Logitec Media Server</a> site and download the version matching your OS choice.</p>
<p>I won't cover the installation of the logitec media server in this article.</p>
<h2>Preparing the raspberry pi sd card:</h2>
<p>I'll show you how to prepare the sd card with a windows computer. This is the SD card we'll use for our network music players.</p>
<ul>
<li>Download and install <a href="https://sourceforge.net/projects/win32diskimager/">Win32 Disk Imager</a></li>
<li>Download <a href="https://www.raspberrypi.org/downloads/raspbian/">Raspbian Stretch Lite</a> image from raspberrypi.org site. (you can also use the full version but there is no need to do so and its bigger)</li>
<li>Use Win32 disk imager to write the rasbian image you have just downloaded to the sd card.</li>
<li>If you plan to connect this player/rpi via wifi, now is the time to configure the wifi network credentials (if you don't do so now you'll have to attach monitor and a keyboard to your rpi later)</li>
</ul>
<p>Create a file <strong>wpa_supplicant.conf</strong> and place it in the boot partition.</p>
<p>wpa_supplicant.conf</p>
<div class="highlight"><pre>ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
network={
    ssid=&quot;YourNetworkSSID-1&quot;
    psk=&quot;passwordOne&quot;
}
</pre></div>


<ul>
<li>To enable ssh create an empty file named <strong>ssh</strong> and place it in the boot partition.</li>
<li>Insert the sd card in the raspberry pi, connect the usb sound card using the cable adapter, conect the 5v power supplay, after less than 1 minute it shold boot and connect to the network.</li>
<li>Now you need to find the ip address of the raspberry pi, you can do that by checking the DHCP clients in you router control panel or use your phone and an application like <a href="https://play.google.com/store/apps/details?id=com.overlook.android.fing">Fing</a> (there is also an iphone version of Fing)</li>
<li>Once you find the ip address ssh to it using <a href="https://www.putty.org/">Putty</a> or your favourite ssh client.
When connecting use user <strong>pi</strong> and password <strong>raspberry</strong></li>
</ul>
<p>After you login for a first time change the defulat password with</p>
<pre>$ passwd</pre>

<ul>
<li>Update your system packages by running</li>
</ul>
<pre>$ sudo apt-get -y update && sudo apt-get -y dist-upgrade</pre>

<p>This will take some time.</p>
<ul>
<li>Install some libraries that are needed by squeezelite </li>
</ul>
<pre>$ sudo apt-get install -y libflac-dev libfaad2 libmad0</pre>

<ul>
<li>Create a folder for squeezelite and download it:</li>
</ul>
<pre>$ mkdir squeezelite
$ cd squeezelite
$ wget -O squeezelite-armv6hf.tar.gz http://www.gerrelt.nl/RaspberryPi/squeezelite_ralph/squeezelite-armv6hf.tar.gz
$ tar -xvzf squeezelite-armv6hf.tar.gz</pre>

<p><a href="https://sourceforge.net/projects/lmsclients/files/squeezelite/linux/">Here</a> you can find Squeezelite and other LMS Clients for different OS.</p>
<ul>
<li>Now set the sound level:</li>
</ul>
<pre>$ sudo alsamixer</pre>

<p>Use the F6 key to select the right soundcard (I am using an USB soundcard), and then set the volume using the arrow keys. Set the volume just before the red zone also set the microphone volume to zero, to make sure it will not cause any noise.</p>
<ul>
<li>Before we can run squeezelite we need to find the name of our usb sound card.</li>
</ul>
<pre>$ ./squeezelite -l</pre>

<p>You'll get an output like the one below:</p>
<div class="highlight"><pre>Output devices:
  null                           - Discard all samples (playback) or generate zero samples (capture)
  pulse                          - PulseAudio Sound Server
  default:CARD=ALSA              - bcm2835 ALSA, bcm2835 ALSA - Default Audio Device
  sysdefault:CARD=ALSA           - bcm2835 ALSA, bcm2835 ALSA - Default Audio Device
  dmix:CARD=ALSA,DEV=0           - bcm2835 ALSA, bcm2835 ALSA - Direct sample mixing device
  dmix:CARD=ALSA,DEV=1           - bcm2835 ALSA, bcm2835 IEC958/HDMI - Direct sample mixing device
  dsnoop:CARD=ALSA,DEV=0         - bcm2835 ALSA, bcm2835 ALSA - Direct sample snooping device
  dsnoop:CARD=ALSA,DEV=1         - bcm2835 ALSA, bcm2835 IEC958/HDMI - Direct sample snooping device
  hw:CARD=ALSA,DEV=0             - bcm2835 ALSA, bcm2835 ALSA - Direct hardware device without any conversions
  hw:CARD=ALSA,DEV=1             - bcm2835 ALSA, bcm2835 IEC958/HDMI - Direct hardware device without any conversions
  plughw:CARD=ALSA,DEV=0         - bcm2835 ALSA, bcm2835 ALSA - Hardware device with all software conversions
  plughw:CARD=ALSA,DEV=1         - bcm2835 ALSA, bcm2835 IEC958/HDMI - Hardware device with all software conversions
  default:CARD=Device            - USB Audio Device, USB Audio - Default Audio Device
  sysdefault:CARD=Device         - USB Audio Device, USB Audio - Default Audio Device
  front:CARD=Device,DEV=0        - USB Audio Device, USB Audio - Front speakers
  surround21:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 2.1 Surround output to Front and Subwoofer speakers
  surround40:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 4.0 Surround output to Front and Rear speakers
  surround41:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 4.1 Surround output to Front, Rear and Subwoofer speakers
  surround50:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 5.0 Surround output to Front, Center and Rear speakers
  surround51:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 5.1 Surround output to Front, Center, Rear and Subwoofer speakers
  surround71:CARD=Device,DEV=0   - USB Audio Device, USB Audio - 7.1 Surround output to Front, Center, Side, Rear and Woofer speakers
  iec958:CARD=Device,DEV=0       - USB Audio Device, USB Audio - IEC958 (S/PDIF) Digital Audio Output
  dmix:CARD=Device,DEV=0         - USB Audio Device, USB Audio - Direct sample mixing device
  dsnoop:CARD=Device,DEV=0       - USB Audio Device, USB Audio - Direct sample snooping device
  hw:CARD=Device,DEV=0           - USB Audio Device, USB Audio - Direct hardware device without any conversions
  plughw:CARD=Device,DEV=0       - USB Audio Device, USB Audio - Hardware device with all software conversions
</pre></div>


<p>Since we are using a USB Audio Device we need to pic one of the liseted USB devices. I am using <strong>front:CARD=Device,DEV=0</strong> as it works best for me. 
You can test the other usb devices and decide for yourself.</p>
<pre>$ ./squeezelite -n Player-location -m 15:c4:20:16:b7:4f -o front:CARD=Device,DEV=0</pre>

<p>-n sets the name of the player - the name that you'll see when you control it.</p>
<p>-m is the mac address of the network player - pick a random mac address - it shuold be unique for each player in your network.</p>
<p>-o is the output device used for the playback (your usb sound card)</p>
<p>If you don't see any error go to logitec media server and check if you see your new player (the players are listed in the top right section of LMS web control panel). </p>
<p>You can test the player to make sure its working properly.
When done testing you can close the server with Ctrl+CARD</p>
<ul>
<li>Starting Squeezelite on Startup</li>
</ul>
<p>There are many ways you can use to start the player on start up. The easiest one I have found is using <strong>crontab</strong>.</p>
<pre>$ crontab -e</pre>

<p>and add this some where in the file </p>
<div class="highlight"><pre>@reboot sudo -u pi /home/pi/squeezelite/squeezelite -n Player_Name -m 15:c4:20:16:b7:4f -o front:CARD=Device,DEV=0 &amp;
</pre></div>


<ul>
<li>Reboot your raspberry pi to make sure the player is loaded on startup.</li>
</ul>
<p>This is all you need to do to create a new network music player for your multy-room audio system. For the other players you need to repeate all the steps descripbed above and pick a different mac (-m) address and name (-n) in the player configuration step.</p>
<h2>Stability of the system</h2>
<p>If you use raspbery pi zero, when playing music the cpu load should be around 0.15 .</p>
<p>The players can work fine on wifi if you have decent wifi coverage.<br>
It is recommended that you run your LM server on a wired connection thus it can also work on wifi.</p>
<p>The stability of the players mainly depends on the choise of the usb sound card. I have tested maybe 5 different cheap (up to $3) sound cards and only the one listed in the parts section works without causing problems. The others will make the player hung in silence or repeating a very annoying souund. </p>
<p>If you want better sound and you can afford to pay more you can build your players with <a href="https://www.hifiberry.com/">HiFiBerry Amplifier</a> or some other rapsberry pi compatible Amplifier.</p>
<p>Using a bad sd card can also affect the system stability.</p>
<p>I am using such multy-room audio system with 2 raspbery pi network players that run 24/7 - one on wifi the other on lan and there are months with no outages.
There is also a third player on my windows desktop pc - this one causes no issues but it is rebooted daily.</p>
<p>If some player - mainly the wifi one - disapears from the network or I don't see it in LMS I just restart it from the plug and it comes back in a minute.</p>
<p>You can start a network player on the computer runing the logitec media server using a build in plugin.</p>
<h2>What media is supported by My Multy-room Audio Sytem?</h2>
<p>Logitec Media Server supports many audio sources that you can enjoy now:</p>
<ul>
<li>Your own MP3 collection, it can be located on any samba share in your network or the computer running the server.</li>
<li>Spotify - you need a paid account.</li>
<li>Many free online sources like SomaFM, SoundClound, TuneIn Radio (tons of online radio stations), You Tube and others - these depends on your location. You can see them all <a href="https://www.mysqueezebox.com/appgallery">here</a>.</li>
<li>Custom streams from URLs you add.</li>
</ul>
<h2>How Can We control the system?</h2>
<p>The easiest way is to use the web interface located at http://server_ip:9000 (you can change that port to 80 from LMS configuration)</p>
<p>You can use a phone app to play your music. The best if found for android phones is <a href="https://play.google.com/store/apps/details?id=uk.org.ngo.squeezer">squeezer</a>. It automatically discovers our lms when you are on the same networks and allows you to control most of the functions of the server.</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="http://home.masoko.net/tag/lms.html">lms</a>
      <a href="http://home.masoko.net/tag/multi-room.html">multi-room</a>
      <a href="http://home.masoko.net/tag/audio.html">audio</a>
      <a href="http://home.masoko.net/tag/spotify.html">spotify</a>
      <a href="http://home.masoko.net/tag/logitec-media-server.html">logitec media server</a>
      <a href="http://home.masoko.net/tag/rpi.html">rpi</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="http://home.masoko.net/multiple-python-sites-on-one-host.html" title="How to Host Multiple Python Apps on the Same Host With Nginx">
      <i class="fa fa-angle-left"></i>     Previous Post

    </a>
  </div>

  <div class="related-posts">
    <h4>    You might enjoy
</h4>
    <ul class="related-posts">
      <li><a href="http://home.masoko.net/rpi-software.html">Software for Raspberry Pi</a></li>
      <li><a href="http://home.masoko.net/iptables-example.html">Basic IPTables Tutorial</a></li>
      <li><a href="http://home.masoko.net/os-raspberry-pi.html">OS for Raspberry Pi</a></li>
    </ul>
  </div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'my-blog-notes';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>&copy;  2018</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " My Blog/Notes ",
  "url" : "http://home.masoko.net",
  "image": "http://home.masoko.net/images/avatar2.jpg",
  "description": "Foo Bar's Thoughts and Writings"
}
</script>

  
	<!-- Start of StatCounter Code for Default Guide -->
	<script type="text/javascript">
	var sc_project=11606772; 
	var sc_invisible=1; 
	var sc_security="2a877137"; 
	var scJsHost = (("https:" == document.location.protocol) ?
	"https://secure." : "http://www.");
	document.write("<sc"+"ript type='text/javascript' src='" +
	scJsHost+
	"statcounter.com/counter/counter.js'></"+"script>");
	</script>
	<noscript><div class="statcounter"><a title="Web Analytics
	Made Easy - StatCounter" href="http://statcounter.com/"
	target="_blank"><img class="statcounter"
	src="//c.statcounter.com/11606772/0/2a877137/1/" alt="Web
	Analytics Made Easy - StatCounter"></a></div></noscript>
	<!-- End of StatCounter Code for Default Guide -->

</body>
</html>